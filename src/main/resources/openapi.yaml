openapi: 3.0.0
info:
  title: Medieval Factions API
  description: REST API for Medieval Factions plugin
  version: {{VERSION}}
  contact:
    name: Medieval Factions
    url: https://github.com/Dans-Plugins/Medieval-Factions
servers:
  - url: http://localhost:{{PORT}}
    description: Local server
paths:
  /api/health:
    get:
      summary: Health check endpoint
      responses:
        '200':
          description: API is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  version:
                    type: string
  /api/factions:
    get:
      summary: Get all factions
      responses:
        '200':
          description: List of all factions
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Faction'
  /api/factions/{id}:
    get:
      summary: Get faction by ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Faction found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Faction'
        '404':
          description: Faction not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/factions/name/{name}:
    get:
      summary: Get faction by name
      parameters:
        - name: name
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Faction found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Faction'
        '404':
          description: Faction not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/players:
    get:
      summary: Get all players
      responses:
        '200':
          description: List of all players
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Player'
  /api/players/{id}:
    get:
      summary: Get player by ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Player found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Player'
        '404':
          description: Player not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /api/relationships:
    get:
      summary: Get all faction relationships
      responses:
        '200':
          description: List of all relationships
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Relationship'
  /api/relationships/faction/{id}:
    get:
      summary: Get relationships for a specific faction
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: List of relationships
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Relationship'
  /api/claims:
    get:
      summary: Get all claims
      responses:
        '200':
          description: List of all claims
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Claim'
  /api/claims/faction/{id}:
    get:
      summary: Get claims for a specific faction
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: List of claims for the faction
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Claim'
        '400':
          description: Invalid faction ID
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
components:
  schemas:
    Faction:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        prefix:
          type: string
          nullable: true
        power:
          type: number
          format: double
        maxPower:
          type: number
          format: double
        memberCount:
          type: integer
        home:
          $ref: '#/components/schemas/Position'
    Player:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
          nullable: true
        power:
          type: number
          format: double
        factionId:
          type: string
          format: uuid
          nullable: true
    Position:
      type: object
      properties:
        world:
          type: string
        x:
          type: number
          format: double
        y:
          type: number
          format: double
        z:
          type: number
          format: double
    Relationship:
      type: object
      properties:
        factionId:
          type: string
          format: uuid
        targetFactionId:
          type: string
          format: uuid
        type:
          type: string
          enum: [ALLY, AT_WAR, LIEGE, VASSAL]
    Claim:
      type: object
      properties:
        worldId:
          type: string
          format: uuid
          description: The UUID of the world where the claim is located
        x:
          type: integer
          description: The x coordinate of the chunk
        z:
          type: integer
          description: The z coordinate of the chunk
        factionId:
          type: string
          format: uuid
          description: The UUID of the faction that owns this claim
    Error:
      type: object
      properties:
        error:
          type: string
        message:
          type: string
